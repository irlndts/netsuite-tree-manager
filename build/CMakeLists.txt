cmake_minimum_required (VERSION 2.8)

#------------------------------------------------------------------------------

set (PROJECT sips_perl_alamaface)

# имя проекта
project ( ${PROJECT} )

set ( CPACK_PACKAGE_VERSION_MAJOR 8)
set ( CPACK_PACKAGE_VERSION_MINOR 0 )
set ( CPACK_PACKAGE_VERSION_PATCH 13 )

#-------------------------------------------------------------------------------
# секция для цели install

install ( DIRECTORY lib DESTINATION ./ PATTERN ".git" EXCLUDE PATTERN "build" EXCLUDE PATTERN "t" EXCLUDE )

#-------------------------------------------------------------------------------
# секция для цели package (сборка RPM)

set ( INSTALL_PREFIX /kmsearch/fe/ )

# CPACK_RPM_<POST/PRE>_<UN>INSTALL_SCRIPT_FILE
set ( CPACK_RPM_PACKAGE_ARCHITECTURE "noarch" )

set ( REQUIRES "perl-AnyEvent-HTTP")
set ( REQUIRES "${REQUIRES}, libapreq2")
set ( REQUIRES "${REQUIRES}, perl-libapreq2")
set ( REQUIRES "${REQUIRES}, perl-URI-Escape-XS")
set ( REQUIRES "${REQUIRES}, libxslt")
set ( REQUIRES "${REQUIRES}, perl-libxml-perl")
set ( REQUIRES "${REQUIRES}, mod_perl")
set ( REQUIRES "${REQUIRES}, thrift")
set ( REQUIRES "${REQUIRES}, thrift-lib-perl")
set ( REQUIRES "${REQUIRES}, fb303-perl")
set ( REQUIRES "${REQUIRES}, perl-AnyEvent")
set ( REQUIRES "${REQUIRES}, perl-JSON-XS")
set ( REQUIRES "${REQUIRES}, perl-MIME-Base64-URLSafe")
set ( REQUIRES "${REQUIRES}, perl-MersenneTwister")
set ( REQUIRES "${REQUIRES}, perl-Digest-SHA1")
set ( REQUIRES "${REQUIRES}, perl-URI-UTF8-Punycode")
set ( CPACK_RPM_PACKAGE_REQUIRES "${REQUIRES}" )

set ( PROVIDES "perl(AlamaFace::Ash::Response)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Ash::Config)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Ash::Request)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Ash::Rules)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Ash::ExtRequest)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Ash::Utils)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Ash::Params)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Params::Ash::Validator)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Logger::Ash::Scribe)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Ash::Corrected)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Ash::QueryAnalyzer)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Ash::FamilyCensorAlt)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Ash::CachedRequest)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Ash::KremlinCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Ash::MinSvjazCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Ash::WebCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Ash::PicturesCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Cache::Ash::Memory)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Cache::Ash::Memcached)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Data::Ash::Dumper)")

set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::ContextAd)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::TopVideos)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::TVBest)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Promt)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::GeoMixer)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::2GIS13)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::GosUslugi)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::TVNow)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::ParallelService)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::CurrenciesChart)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::JobWidget)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::NewsCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::MyHouse::FIAS)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Currency::Exchange)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Metro)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::CurrencyExchange)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::BlogsCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::GosService::Catalog)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::GosService::Item)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::GosService::Question)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::GosService::ByPath)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::GosService::Category)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::TVProgram)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::MetaCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Location)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Popular)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Area)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Countries)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Statistics)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Country)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Areas)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::Cities)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::City::Area)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Geo::City::Country)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Weather)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::MyHouse)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::TVEvent)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::LatestNews)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::NewsFetcher)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::HealthCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::ZabavaCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::2GIS::Detail)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::VideoCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Afisha::Event)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Afisha::Place)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Afisha::Places)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Afisha::Types)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Afisha::Events)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Health::Description)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Health::RLS)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::NewsWidget)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Maps)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::DPICollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::TVSearch)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::BlogsTop)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::NewsCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::KidsCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::VideoCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::PicturesCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::EPGUCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::GosBarCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::GosBarSiteCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Meta::GosCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::WebCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::RandomPhrase)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::NewsCategoryTitles)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Tv::Online)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Translate::AutoDetectLang)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Translate::URL)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Translate::Text)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::2GIS)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::PicturesCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::JobCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Thrift::WebCollection)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Promt::GetPTServiceDataSet)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Promt::GetDirectionDataSet)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::News::Top)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest::Hotwater)")

set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::RandomPhrase)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::NewsCategoryTitles)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::NewsAggregator)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Currency)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::NewsFetcher)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Captcha::Get)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Captcha::Check)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Captcha::CheckDeti)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Captcha::CheckFeedback)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Captcha::CheckResume)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Captcha::CheckWebmaster)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::FamilyCensorAlt)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::CachedRequest)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::BlogsTop)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Pharmacy)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Meta::Corrected)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Corrected)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::QueryAnalyzer)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::1957)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::ParallelService)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Suggests)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::GosService::Privileges)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::GosService::Questions)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::QueryProcessing)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Maps)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Maps3)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Maps::POI)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Maps::Points)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Geo::HTTP)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest::Geo::Thrift)")

set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Cache::Memory)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Cache::DNS)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Cache::Memcached)")

set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Meta::Response)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Meta::Request)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Meta::ExtRequest)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Meta::Params)")

set ( PROVIDES "${PROVIDES}, perl(AlamaFace::DNS)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Request)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Rules)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::ExtRequest)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Utils)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Params)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Config)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Logger::Scribe)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Data::Dumper)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Logger::Dumper)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Params::Validator)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Response)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::CachData)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::PerlRequest)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::AnyEvent::Delay::Simple)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::AnyEvent::FIFO)")
set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Random)")

set ( PROVIDES "${PROVIDES}, perl(AlamaFace::Testing::AB)")
set ( PROVIDES "${PROVIDES}, perl(Mock::AlamaFace::Abc)")
set ( CPACK_RPM_PACKAGE_PROVIDES "${PROVIDES}" )


set ( OBSOLETES "sips_perl_alamaface-extrequest-cachedrequest-dpicollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-weather")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-currencyexchange")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-latestnews")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-videocollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-gosuslugi")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-myhouse")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-currency")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-gosservice")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-maps")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-webcollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-newswidget")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-2gis")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-healthcollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-blogscollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-blogstop")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-afisha")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-zabavacollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-contextad")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-randomphrase")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-metacollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-newscollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-jobcollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-metro")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-geomixer")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-currencieschart")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-picturescollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-topvideos")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-tv")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-jobwidget")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-promt")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-ash-webcollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-ash-kremlincollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-cachedrequest-ash-picturescollection")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-ash-familycensoralt")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-ash-corrected")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-ash-queryanalyzer")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-ash-core")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-core")
set ( OBSOLETES "${OBSOLETES}, sips_perl_mock-alamaface-abc")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-familycensoralt")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-newscategorytitles")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-currency")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-newsfetcher")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-queryprocessing")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-maps")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-geo")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-blogstop")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-pharmacy")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-captcha")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-corrected")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-randomphrase")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-1957")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-newsaggregator")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-queryanalyzer")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-parallelservice")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-extrequest-suggests")
set ( OBSOLETES "${OBSOLETES}, sips_perl_alamaface-cachdatarequests")
set ( CPACK_RPM_PACKAGE_OBSOLETES "${OBSOLETES}")

set ( CPACK_GENERATOR RPM )
set ( CMAKE_INSTALL_PREFIX ${INSTALL_PREFIX} )
set ( CPACK_SET_DESTDIR ON)
set ( CPACK_PACKAGE_VERSION ${CPACK_PACKAGE_VERSION_MAJOR}.${CPACK_PACKAGE_VERSION_MINOR}.${CPACK_PACKAGE_VERSION_PATCH} )
set ( CPACK_PACKAGE_CONTACT "Dmitry Bolsanov <bolsanov@corp.sputnik.ru>")
set ( CPACK_PACKAGE_DESCRIPTION_SUMMARY "AlamaFace perl packages" )
set ( CPACK_RPM_PACKAGE_ARCHITECTURE "${CMAKE_SYSTEM_PROCESSOR}" )
set ( CPACK_PACKAGE_NAME ${PROJECT} )
set ( CPACK_PACKAGE_VENDOR "LLC 'Sputnik.ru'" )
set ( CPACK_SYSTEM_NAME ${CMAKE_SYSTEM_PROCESSOR} )
set ( PROJECT_VERSION_REVISION 1 )
set ( PROJECT_RELEASE_ID ${PROJECT_VERSION_REVISION} )
set ( CPACK_RPM_PACKAGE_ARCHITECTURE "${CMAKE_SYSTEM_PROCESSOR}" )
execute_process ( COMMAND sed -nr "s/^.+\\s([0-9]+).*/kmm\\1/p" /etc/issue
                  COMMAND tr -d "\n"
                  OUTPUT_VARIABLE CPACK_RPM_PACKAGE_OS_VERSION )
set ( CPACK_RPM_PACKAGE_RELEASE "r${PROJECT_VERSION_REVISION}.${CPACK_RPM_PACKAGE_OS_VERSION}" )
set ( CPACK_PACKAGE_FILE_NAME "${CPACK_PACKAGE_NAME}-${CPACK_PACKAGE_VERSION}-${CPACK_RPM_PACKAGE_RELEASE}.${CMAKE_SYSTEM_PROCESSOR}" )

INCLUDE(CPack)

add_custom_target ( test )
add_custom_command ( TARGET test
                     COMMAND cd ${CMAKE_CURRENT_SOURCE_DIR}/t
                     COMMAND ${CMAKE_CURRENT_SOURCE_DIR}/t/run_unit-tests >> ${CMAKE_CURRENT_SOURCE_DIR}/t/test.results
                     WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}
                     COMMENT "Running tests..."
                     VERBATIM
                   )
add_dependencies ( test run_unit-tests )
